## ACC-014: Chart of Accounts

**Route:** /accounting/chart-of-accounts
**Component:** src/pages/accounting/ChartOfAccountsPage.tsx (thin wrapper around ChartOfAccountsTab)
**Guard:** accounting.invoices.read (via ROUTE_PERMISSION_MAP['accounting'])

### Roles
- Full access (bypass): super_admin, owner, operations_manager
- Navigation-level: FINANCIAL_ROLES, requiredPermissions: ['financial.journal_entries.view']
- Route guard resolves to: DENIED for all non-FULL_ACCESS_ROLES (accounting.invoices.read not in permissionMappings.ts)

### Database
- Primary: chart_of_accounts (via useAccounting -> supabase.from('chart_of_accounts'))
- Filters: business_id, is_active=true, ordered by account_code
- Also loads: journal_entries (limit 100), invoices (limit 50), expenses (limit 50) — all loaded by useAccounting but not used by this tab
- Additional hook: usePOSAccounting (for createDefaultAccounts)

### Behavior
1. Page is a thin wrapper: renders DashboardLayout > heading > ChartOfAccountsTab
2. ChartOfAccountsTab uses useAccounting hook which queries chart_of_accounts filtered by business_id + is_active=true
3. Accounts are grouped by type: asset, liability, equity, revenue, expense (5 groups)
4. Each group renders as a Card with a colored Badge header and account count
5. Each group's table has sortable/draggable columns: Code, Account Name, Balance, Actions
6. Column preferences: users can reorder, show/hide columns via ColumnSettingsModal (stored in useColumnPreferences('chart-of-accounts'))
7. Actions column: View (opens ViewAccountModal), Edit (button exists but no handler), Delete (button exists but disabled for system accounts, no handler for non-system)
8. "Add Account" button opens a Dialog with form: account_code, account_name, account_type (select), description
9. createAccount calls supabase.from('chart_of_accounts').insert() with business_id
10. "Create Default Accounts" button calls usePOSAccounting().createDefaultAccounts
11. Account type color coding: asset=blue, liability=red, equity=green, revenue=violet, expense=orange
12. ViewAccountModal supports navigation between accounts within the same type (prev/next)
13. System accounts are marked with a "System" Badge and cannot be deleted
14. Multi-sort supported via useSortableData hook (default sort: account_code asc)

### Scaffolding Flags
- DEAD HANDLER: Edit button (line 175-176) renders `<Button variant="ghost" size="sm"><Edit /></Button>` with NO onClick handler — clicking does nothing
- DEAD HANDLER: Delete button (line 177-179) renders `<Button variant="ghost" size="sm" disabled={account.is_system_account}><Trash2 /></Button>` with NO onClick handler — clicking does nothing even for non-system accounts
