## ACC-008: POS End of Day

**Route:** /pos-end-of-day
**Component:** src/pages/accounting/POSEndOfDayPage.tsx (exports POSEndOfDayPage + POSEndOfDayContent)
**Guard:** accounting.invoices.read (via ROUTE_PERMISSION_MAP['pos-end-of-day'] -> 'accounting.invoices.read')

### Roles
- Full access (bypass): super_admin, owner, operations_manager
- Navigation-level: Not explicitly defined in NAVIGATION_PERMISSIONS for pos-end-of-day
- Route guard resolves to: DENIED for all non-FULL_ACCESS_ROLES (accounting.invoices.read not in permissionMappings.ts)

### Database
- Primary: `cash_drawer_sessions`
- Joins: None (selects `*` only)
- Filters: business_id (from useBusiness), closeout_status (tab-based: pending_review, needs_info, closed, or all), closed_at (date filter with start/end of day range)

### Behavior
1. Fetches cash_drawer_sessions by business_id and closeout_status filter, ordered by closed_at descending
2. Displays summary cards: Pending Review count, Needs Info count, Closed Today count
3. Tab-based filtering: Pending (pending_review), Needs Info (needs_info), Closed (closed), All
4. Client-side search filter by terminal_id and cashier_name
5. Date filter input filters server-side by closed_at within that day
6. Each closeout card shows: terminal_id, status badge, requires_approval flag, cashier_name, closed_at, expected cash (opening_amount), variance (difference)
7. Variance badge: "Balanced" (green, < $0.01), "Over: $X" (blue, positive), "Short: $X" (red, negative)
8. Cashier notes displayed if present (blue highlight box)
9. "View Details" button opens CloseoutDetailModal
10. POSEndOfDayContent exported separately (for use in tabs — without DashboardLayout)
11. POSEndOfDayPage wraps content in DashboardLayout (for direct route access)
12. useEffect re-fetches when activeTab changes (triggers new query with different status filter)
13. Counts (pendingCount, needsInfoCount, closedCount) computed from closeouts array — but this array is filtered by activeTab, so counts may only reflect the currently selected status

### Scaffolding Flags
- None found in POSEndOfDayPage.tsx — all behaviors have real Supabase queries and real UI rendering
- Note: The "Closed Today" count label says "Closed Today" but actually counts all closed sessions, not just today's
