## ACC-005: Expenses List

**Route:** /accounting/expenses
**Component:** src/pages/accounting/ExpensesPage.tsx (wrapper) -> src/components/accounting/ExpensesTab.tsx (main)
**Guard:** accounting.invoices.read (via ROUTE_PERMISSION_MAP['accounting'])

### Roles
- Full access (bypass): super_admin, owner, operations_manager
- Navigation-level: FINANCIAL_ROLES + ap_specialist (from NAVIGATION_PERMISSIONS, uses financial.ap.view)
- Route guard resolves to: DENIED for all non-FULL_ACCESS_ROLES (accounting.invoices.read not in permissionMappings.ts)

### Database
- Primary: `expenses`
- Joins: None in list query (useExpensesPaginated selects `*` only — no joins)
- Filters: business_id (from useBusiness), category, status, payment_method, date_from, date_to, search (vendor, description, reference_number, notes via ilike)

### Behavior
1. Fetches expenses via useExpensesPaginated hook with server-side pagination (default 20 per page)
2. Displays summary stats: Total Expenses amount, Approved amount, Pending amount, This Month amount (computed from loaded expenses array)
3. Status filter dropdown: all, draft, pending_approval, approved, rejected — applied server-side
4. Sortable table columns via useSortableData with default sort by expense_date desc
5. Draggable column headers for reorder via DraggableTableHead + useColumnPreferences
6. Column visibility settings via ColumnSettingsModal
7. Table columns: expense_number, expense_date, description, category, total_amount, status, employee (submitted by), actions
8. Clicking a row opens ExpenseDetailsModal (not navigation)
9. View button (eye icon) opens ExpenseDetailsModal
10. Edit button (pencil icon) only visible for draft status — opens CreateExpenseModal with selectedExpense
11. "New Expense" button opens CreateExpenseModal
12. Pagination controls with page size options [10, 20, 50, 100]
13. ExpensesPage.tsx is a thin wrapper with DashboardLayout
14. Employee name shown from expense data (but no join in query — relies on data being present)
15. Navigation between expenses in detail modal via handleNavigateExpense (prev/next)

### Scaffolding Flags
- None found in ExpensesTab.tsx
- Note: Employee column references `expense.employees.first_name` / `last_name` but the hook query does NOT join employees table. This will show "Unknown" for all expenses unless the `expenses` select returns nested employee data via RLS/views.
